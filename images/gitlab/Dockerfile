# --- Do Not Edit ---
#
# This dockerfile is generated by a bazel rule
#
FROM ghcr.io/cardboardci/base@sha256:bbf36e6f9e1ff487b92a81e0a1f5fbad9bac9453dbdd3ae6c06631e27999238c

USER root

ARG DEBIAN_FRONTEND=noninteractive

COPY rootfs/ /
RUN chmod +x /usr/local/bin/* || true

COPY provision/pkglist /cardboardci/pkglist
RUN apt-get update && xargs -a /cardboardci/pkglist apt-get install -y && apt-get clean && rm -rf /var/lib/apt/lists/*

COPY provision/binlist /cardboardci/binlist
RUN mkdir -p /tmp/bin/ && xargs -a /cardboardci/binlist -I {} bash -c 'wget $(echo "{}" | cut -d '=' -f1) -O /tmp/bin/$(echo "{}" | cut -d= -f2)' && chmod +x /tmp/bin/* && mv /tmp/bin/* /usr/bin/ && rm -rf tmp/bin

RUN curl -sSL 'https://raw.githubusercontent.com/zaquestion/lab/master/install.sh' -o /tmp/install.sh && sync && bash /tmp/install.sh

USER cardboardci

##
## Image Metadata
##
ARG vcs_ref
LABEL \
    maintainer="CardboardCI" \
    org.opencontainers.image.schema-version="1.0" \
    org.opencontainers.image.name="gitlab" \
    org.opencontainers.image.release="CardboardCI version:0.0.0" \
    org.opencontainers.image.vendor="cardboardci" \
    org.opencontainers.image.architecture="amd64" \
    org.opencontainers.image.summary="GitLab CLI" \
    org.opencontainers.image.description=" Lab wraps Git or Hub, making it simple to clone, fork, and interact with repositories on GitLab" \
    org.opencontainers.image.url="https://github.com/cardboardci/dockerfiles" \
    org.opencontainers.image.changelog-url="https://github.com/cardboardci/dockerfiles" \
    org.opencontainers.image.authoritative-source-url="https://github.com/cardboardci/dockerfiles" \
    org.opencontainers.image.distribution-scope="public" \
    org.opencontainers.image.vcs-type="git" \
    org.opencontainers.image.vcs-url="https://github.com/cardboardci/dockerfiles" \
    org.opencontainers.image.vcs-ref="${vcs_ref}"